library(tidyverse)
options(scipen = 999)
df <- read.csv(file = "../data/all_export.csv", row.names = NULL)
colnames(df) <- colnames(df)[2:ncol(df)]
df <- df[1:(ncol(df)-1)]
df <- df[c("refYear", "reporterISO", "reporterDesc", "partnerDesc", "cmdCode",
"qtyUnitAbbr", "qty", "altQtyUnitAbbr", "altQty", "primaryValue")]
colnames(df)[1] <- "date"
df$date <- lubridate::ymd(df$date, truncated = 2L)
df <- df %>% group_by(reporterISO) %>% summarise(total = sum(primaryValue))
sf_world <- st_as_sf(rworldmap::getMap(resolution = "low")) %>% st_transform(crs = "+proj=moll") %>% dplyr::select(ISO_N3, ISO_A3)
colnames(sf_world)[2] <- "reporterISO"
test <- merge(sf_world, df, by = "reporterISO", all.x = TRUE)
#RecordLinkage::levenshteinSim(df$reporterDesc, sf_world$name)
#test$total <- rescale(test$total,newrange = c(-2,3))
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = F,
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = -2:3,
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = -2:3,
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
theme_set(theme_minimal())
theme_update(
axis.ticks = element_blank(),
axis.text = element_blank(),
panel.grid.major = element_line(color = "grey88",
size = 0.5),
panel.background = element_rect(color = NA,
fill = "grey98"),
plot.background = element_rect(color = NA,
fill = "grey98"),
plot.title = element_text(
#family = "Merriweather Sans ExtraBold",
color = "black",
size = 42,
face = "bold",
hjust = 0.5,
margin = margin(t = 24, b = 6)),
plot.subtitle = element_text(
#family = "Merriweather",
color = "black",
size = 15,
face = "plain",
hjust = 0.5,
margin = margin(t = 18, b = 0)),
plot.caption = element_text(
#family = "Merriweather Black",
color = "grey60",
size = 15,
hjust = 0.5,
margin = margin(t = 0, b = 24)),
legend.position = "top",
legend.text = element_text(
#family = "Merriweather Sans",
color = "black",
size = 15),
legend.key.width = unit(7, "lines"),
legend.key.height = unit(0.8, "lines")
)
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = -2:3,
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
test$highlight <- test$total
test[test$reporterISO == "ZAF",]$highlight <- "yes"
test[test$reporterISO == "KENF",]$highlight <- "yes"
test$highlight <- test$total
test[test$reporterISO == "ZAF",]$highlight <- "yes"
test[test$reporterISO == "KENF",]$highlight <- "yes"
test[test$reporterISO == "KENF",]$highlight
test$highlight <- test$total
test[test$reporterISO == "ZAF",]$highlight <- "yes"
test[test$reporterISO == "KEN",]$highlight <- "yes"
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = highlight, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = -2:3,
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
scale_color_manual(values = c('yes' = 'red')) +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = highlight, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = -2:3,
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
scale_color_manual(values = c('yes' = 'red'), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
)
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = highlight, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = -2:3,
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
#scale_color_manual(values = c('yes' = 'red'), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = -2:3,
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
#scale_color_manual(values = c('yes' = 'red'), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
View(df)
-2:3
df <- read.csv(file = "../data/all_export.csv", row.names = NULL)
colnames(df) <- colnames(df)[2:ncol(df)]
df <- df[1:(ncol(df)-1)]
df <- df[c("refYear", "reporterISO", "reporterDesc", "partnerDesc", "cmdCode",
"qtyUnitAbbr", "qty", "altQtyUnitAbbr", "altQty", "primaryValue")]
colnames(df)[1] <- "date"
df$date <- lubridate::ymd(df$date, truncated = 2L)
View(df)
df %>% group_by(reporterISO, date) %>% summarise(total = sum(primaryValue))
df %>% group_by(reporterISO) %>% summarise(min_date = min(date), max_date = max(date))
df %>% group_by(reporterISO, date) %>% summarise(total = sum(primaryValue))
df <- read.csv(file = "../data/all_export.csv", row.names = NULL)
colnames(df) <- colnames(df)[2:ncol(df)]
df <- df[1:(ncol(df)-1)]
df <- df[c("refYear", "reporterISO", "reporterDesc", "partnerDesc", "cmdCode",
"qtyUnitAbbr", "qty", "altQtyUnitAbbr", "altQty", "primaryValue")]
colnames(df)[1] <- "date"
df$date <- lubridate::ymd(df$date, truncated = 2L)
df <- df %>% group_by(reporterISO) %>% summarise(total = sum(primaryValue))
#df %>% group_by(reporterISO, date) %>% summarise(total = sum(primaryValue))
#df %>% group_by(reporterISO) %>% summarise(min_date = min(date), max_date = max(date))
sf_world <- st_as_sf(rworldmap::getMap(resolution = "low")) %>%
st_transform(crs = "+proj=moll") %>% dplyr::select(ISO_N3, ISO_A3)
colnames(sf_world)[2] <- "reporterISO"
test <- merge(sf_world, df, by = "reporterISO", all.x = TRUE)
#RecordLinkage::levenshteinSim(df$reporterDesc, sf_world$name)
#test$total <- rescale(test$total,newrange = c(-2,3))
test$highlight <- test$total
test[is.na(test$highlight),]$highlight <- 0
test[test$reporterISO == "ZAF",]$highlight <- NA
test[test$reporterISO == "KEN",]$highlight <- NA
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "white",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = -2:3,
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
#scale_color_manual(values = c('yes' = 'red'), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = highlight, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "white",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = -2:3,
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
#scale_color_manual(values = c('yes' = 'red'), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = c(),
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
#scale_color_manual(values = c('yes' = 'red', 'no' = "transparent"), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
test$total <- round(test$total/1000000, 0)
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = c(),
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
#scale_color_manual(values = c('yes' = 'red', 'no' = "transparent"), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
#scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
#scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1
#limits = c(-2, 3),
#breaks = c(),
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
#scale_color_manual(values = c('yes' = 'red', 'no' = "transparent"), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
View(test)
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
#scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
#scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1,
#limits = c(-2, 3),
breaks = c(10000,50000,100000,200000,300000,400000,500000),
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
#scale_color_manual(values = c('yes' = 'red', 'no' = "transparent"), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data")
ggplot(data = test) +
geom_sf(color = "grey70",
fill = "grey80",
lwd = 0.1) +
geom_sf(aes(color = total, fill = total), lwd = 0.1, alpha = 0.9) +
#scale_x_continuous(breaks = seq(-180, 180, by = 30)) +
#scale_y_continuous(breaks = c(seq(-80, 80, by = 20), 85)) +
rcartocolor::scale_color_carto_c(palette = "Fall",
na.value = "transparent",
guide = "none",
direction = -1
#limits = c(-2, 3)
) +
rcartocolor::scale_fill_carto_c(palette = "Fall",
na.value = "grey95",
name = NULL,
direction = -1,
#limits = c(-2, 3),
breaks = c(10000,50000,100000,200000,300000,400000,500000),
#labels = c("-2%", "-1%", "±0%", "+1%", "+2%", "\u2265 +3%")
) +
#scale_color_manual(values = c('yes' = 'red', 'no' = "transparent"), guide = "none") +
guides(fill = guide_legend(title.position = "top",
title.hjust = 0.5, nrow = 1,
label.position = "top")) +
labs(x = NULL, y = NULL,
title = "Gold Export Value over 2017 - 2023",
subtitle = "total gold export value in USD",
caption = "comtrade data") +
annotate("segment", x = 5, xend = 5.5, y = 2.2, yend = 2.4, colour = "blue")
View(test)
View(test[[4]][[1]])
test$geometry
test$geometry[1]
