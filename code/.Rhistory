plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,30000000)) +
scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date(expand = c(0.01,0.01), breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = "Kenya") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
#| code-fold: true
country <- "Kenya"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,30000000)) +
scale_y_continuous(expand = c(0.01,0.01), labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date( breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = "Kenya") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
#| code-fold: true
country <- "Kenya"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,30000000)) +
scale_y_continuous(expand = c(0,0), labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date( breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = "Kenya") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
#| code-fold: true
country <- "Kenya"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,30000000)) +
scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date(breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = "Kenya") +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
#| code-fold: true
country <- "Kenya"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,30000000)) +
scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date(breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = "Kenya") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
ydf <- read.csv('../data/yearly_cleaned_export.csv')
ydf$date <- lubridate::ymd(ydf$date, truncated = 2L)
ydf$flow <- "Export Reported"
ydf2 <- read.csv('../data/yearly_cleaned_import.csv')
ydf2$date <- lubridate::ymd(ydf2$date, truncated = 2L)
ydf2$flow <- "Import Reported"
ydf <- rbind(ydf, ydf2)
rm(ydf2)
#| code-fold: true
country <- "Kenya"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,30000000)) +
scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date(breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = "Kenya") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
#| code-fold: true
country <- "South Africa"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,30000000)) +
scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date(breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = "Kenya") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
#| code-fold: true
country <- "South Africa"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,max(plot_df$sum))) +
scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date(breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = "Kenya") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
#| code-fold: true
country <- "South Africa"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,max(plot_df$sum))) +
scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date(breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = country) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
#| code-fold: true
country <- "Kenya"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,max(plot_df$sum))) +
scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date(breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = country) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
#| code-fold: true
country <- "Kenya"
plot_df <- ydf[ydf$reporterDesc == country & ydf$bricsflag %in% c('b', 'w') & ydf$cmdCode == 7108,]
plot_df <- plot_df %>% group_by(flow, bricsflag, date) %>% summarise(sum = sum(primaryValue))
breaks.vec <- seq(min(plot_df$date), max(plot_df$date), by = "1 year")
ggplot(plot_df, aes(date, sum, fill = bricsflag))+
geom_bar(stat = "identity", position = position_dodge(preserve = "single"))+
coord_cartesian(ylim = c(0,max(plot_df$sum))) +
scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
scale_x_date(breaks = breaks.vec, date_labels = "%Y") +
ylab("Gold Export Value (USD)") + xlab("Date") +
guides(fill = guide_legend(title = 'Country Group')) +
scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue")) +
labs(title = country) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
facet_grid( ~ flow)
# bottom part
# p1 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(0,6000000))+ #setting the down part
#   scale_y_continuous(labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   ylab("Gold Export Value (USD)") + xlab("Date") +
#   guides(fill=guide_legend(title='Country Group')) +
#   scale_fill_manual(labels = c("BRICS", "West"), values = c("red", "blue"))+
#   theme_classic()
#
# # top part
# p2 <- ggplot(data=plot_df,aes(date,sum,fill=bricsflag))+
#   geom_bar(stat = "identity", position=position_dodge(preserve = "single"))+
#   coord_cartesian(ylim = c(8800000,30000000))+ #setting the upper part
#   scale_y_continuous(breaks = c(8800000, 15000000, 30000000),
#                      labels = scales::label_dollar(scale_cut = scales::cut_short_scale()))+
#   scale_fill_manual(values = c("red", "blue"))+
#   guides(x = "none")+ # remove x line
#   labs(title = "Kenya gold exports to BRICS and West")+
#   theme_classic()+
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         axis.title = element_blank(),
#         legend.position = "none", # remove legend
#         panel.background = element_blank(),
#         axis.line = element_line(colour = "black"))
#
# #patchwork
# p2/p1
